name = "violet-vault-bug-reporter"
main = "bug-report-worker.ts"
compatibility_date = "2024-01-01"

# Environment variables (set these in Cloudflare Dashboard → Workers → violet-vault-bug-reporter → Settings → Variables)
# REQUIRED VARIABLES:
# GITHUB_TOKEN = "your-fine-grained-github-token"  (Issues: Write, Metadata: Read permissions)
# GITHUB_REPO = "thef4tdaddy/violet-vault"
#
# OPTIONAL VARIABLES:
# R2_PUBLIC_DOMAIN = "your-r2-domain.com" (for screenshot hosting with custom domain)  
# NOTIFICATION_WEBHOOK = "https://hooks.slack.com/..." (for Slack/Discord notifications)
#
# MILESTONE WORKFLOW:
# - Milestones are updated on Saturdays
# - Frontend caches milestone data for 7 days (expires Sunday)
# - This minimizes API calls to ~1 per week per user
#
# REMINDER: After adding/changing variables in Cloudflare Dashboard, redeploy with:
# npx wrangler deploy

# R2 bucket binding for screenshot storage
[[r2_buckets]]
binding = "R2_BUCKET"
bucket_name = "violetvault"
preview_bucket_name = "violetvault-preview"

# Cron triggers for automated cleanup
[triggers]
crons = ["0 2 * * 1"] # Every Monday at 2 AM UTC

# Routes - adjust based on your domain setup
[env.production]
routes = [
  "https://api.your-domain.com/bug-report/*"
]

[env.staging]
routes = [
  "https://api-staging.your-domain.com/bug-report/*"
]